<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>청년 성격유형검사 - DiSC & MBTI & 스트레스 관리</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
            position: relative;
        }

        .header h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        /* 네비게이션 바 */
        .navbar {
            position: absolute;
            top: 0;
            right: 0;
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .nav-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid rgba(255,255,255,0.3);
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-btn:hover {
            background: rgba(255,255,255,0.3);
            border-color: rgba(255,255,255,0.5);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .nav-btn.login {
            background: linear-gradient(45deg, #667eea, #764ba2);
            border-color: transparent;
        }

        .nav-btn.login:hover {
            background: linear-gradient(45deg, #5a6fd8, #6a4190);
        }

        .user-info {
            display: none;
            align-items: center;
            gap: 15px;
            color: white;
        }

        .user-info.active {
            display: flex;
        }

        .user-name {
            font-weight: 600;
            font-size: 0.9rem;
        }

        .logout-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 1px solid rgba(255,255,255,0.3);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .logout-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-1px);
        }

        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .test-card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .test-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }

        .test-card h2 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.8rem;
        }

        .test-card p {
            color: #666;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .test-icon {
            font-size: 3rem;
            margin-bottom: 20px;
            color: #667eea;
        }

        .start-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }

        .start-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .start-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .start-btn:disabled:hover {
            transform: none;
            box-shadow: none;
        }

        .login-required-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            text-align: center;
            padding: 20px;
        }

        .login-required-overlay h3 {
            margin-bottom: 10px;
            font-size: 1.2rem;
        }

        .login-required-overlay p {
            margin-bottom: 20px;
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .login-required-btn {
            background: linear-gradient(45deg, #28a745, #20c997);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .login-required-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.4);
        }

        .test-section {
            display: none;
            background: white;
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .test-section.active {
            display: block;
        }

        .question {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 15px;
            border-left: 5px solid #667eea;
        }

        .question h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .options {
            display: grid;
            gap: 10px;
        }

        .option {
            padding: 15px;
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .option:hover {
            border-color: #667eea;
            background: #f8f9ff;
        }

        .option.selected {
            border-color: #667eea;
            background: #667eea;
            color: white;
        }

        .option input[type="radio"] {
            margin-right: 10px;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(45deg, #667eea, #764ba2);
            transition: width 0.3s ease;
            width: 0%;
        }

        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }

        .nav-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .nav-btn.prev {
            background: #6c757d;
            color: white;
        }

        .nav-btn.next {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }

        .nav-btn:hover {
            transform: scale(1.05);
        }

        .nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .result-section {
            display: none;
            background: white;
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .result-section.active {
            display: block;
        }

        .result-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .result-type {
            font-size: 2.5rem;
            color: #667eea;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .result-description {
            font-size: 1.2rem;
            color: #666;
            margin-bottom: 30px;
        }

        .result-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .detail-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            border-left: 5px solid #667eea;
        }

        .detail-card h4 {
            color: #333;
            margin-bottom: 10px;
        }

        .chart-container {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
        }

        .chart-bar {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .chart-label {
            width: 100px;
            font-weight: bold;
        }

        .chart-fill {
            height: 20px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            border-radius: 10px;
            margin-left: 10px;
            transition: width 0.5s ease;
        }

        .back-to-tests {
            text-align: center;
            margin-top: 30px;
        }

        .back-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 25px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        /* 테스트 진행 중 상단 네비게이션 */
        .test-header {
            display: none;
            background: white;
            padding: 15px 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            align-items: center;
            justify-content: space-between;
        }

        .test-header.active {
            display: flex;
        }

        .test-title {
            font-size: 1.5rem;
            color: #333;
            font-weight: 600;
        }

        .test-nav-buttons {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .home-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .home-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .test-progress-info {
            color: #666;
            font-size: 0.9rem;
        }

        .footer {
            text-align: center;
            color: white;
            margin-top: 50px;
            padding: 20px;
            opacity: 0.8;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .test-grid {
                grid-template-columns: 1fr;
            }
            
            .container {
                padding: 10px;
            }
            
            .test-section, .result-section {
                padding: 20px;
            }

            /* 모바일 네비게이션 */
            .navbar {
                position: relative;
                justify-content: center;
                margin-bottom: 20px;
            }

            .nav-btn {
                padding: 8px 15px;
                font-size: 0.8rem;
            }

            .user-info {
                flex-direction: column;
                gap: 10px;
                text-align: center;
            }

            .user-name {
                font-size: 0.8rem;
            }

            .logout-btn {
                padding: 6px 12px;
                font-size: 0.7rem;
            }

            /* 모바일 테스트 헤더 */
            .test-header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }

            .test-title {
                font-size: 1.2rem;
            }

            .test-nav-buttons {
                flex-direction: column;
                gap: 10px;
            }

            .home-btn {
                padding: 8px 16px;
                font-size: 0.8rem;
            }

            .test-progress-info {
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <!-- 네비게이션 바 -->
            <div class="navbar">
                <!-- 로그인하지 않은 상태 -->
                <div id="guest-nav">
                    <a href="login.html#signup" class="nav-btn">
                        <i class="fas fa-user-plus"></i>
                        회원가입
                    </a>
                    <a href="login.html" class="nav-btn login">
                        <i class="fas fa-sign-in-alt"></i>
                        로그인
                    </a>
                </div>
                
                <!-- 로그인한 상태 -->
                <div id="user-nav" class="user-info">
                    <span class="user-name" id="user-name">사용자님</span>
                    <a href="userresult.html" class="nav-btn" style="padding: 8px 15px; font-size: 0.8rem;">
                        <i class="fas fa-user"></i>
                        마이페이지
                    </a>
                    <button class="logout-btn" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i>
                        로그아웃
                    </button>
                </div>
            </div>
            
            <h1><i class="fas fa-brain"></i> 청년 성격유형검사</h1>
            <p>DiSC • MBTI • 스트레스 관리 척도로 나를 더 깊이 알아보세요</p>
        </div>

        <!-- 테스트 진행 중 상단 네비게이션 -->
        <div id="test-header" class="test-header">
            <div class="test-title" id="current-test-title">DiSC 성격유형검사</div>
            <div class="test-nav-buttons">
                <div class="test-progress-info" id="test-progress-info">1/5</div>
                <button class="home-btn" onclick="backToMain()">
                    <i class="fas fa-home"></i>
                    메인으로
                </button>
            </div>
        </div>

        <!-- 메인 테스트 선택 화면 -->
        <div id="main-menu" class="test-grid">
            <div class="test-card" onclick="startTest('disc')">
                <div class="test-icon">
                    <i class="fas fa-users"></i>
                </div>
                <h2>DiSC 성격유형검사</h2>
                <p>Dominance(지배형), Influence(영향형), Steadiness(안정형), Conscientiousness(신중형)으로 나누어 당신의 행동 스타일과 의사소통 방식을 분석합니다.</p>
                <button class="start-btn" id="disc-start-btn">검사 시작하기</button>
                <div class="login-required-overlay" id="disc-login-overlay" style="display: none;">
                    <h3><i class="fas fa-lock"></i> 로그인이 필요합니다</h3>
                    <p>검사를 시작하려면 먼저 로그인해주세요</p>
                    <a href="login.html" class="login-required-btn">로그인하기</a>
                </div>
            </div>

            <div class="test-card" onclick="startTest('mbti')">
                <div class="test-icon">
                    <i class="fas fa-user-friends"></i>
                </div>
                <h2>MBTI 성격유형검사</h2>
                <p>16가지 성격유형으로 나누어 당신의 인지 기능과 성격 특성을 분석합니다. 직업 선택과 인간관계에 도움이 됩니다.</p>
                <button class="start-btn" id="mbti-start-btn">검사 시작하기</button>
                <div class="login-required-overlay" id="mbti-login-overlay" style="display: none;">
                    <h3><i class="fas fa-lock"></i> 로그인이 필요합니다</h3>
                    <p>검사를 시작하려면 먼저 로그인해주세요</p>
                    <a href="login.html" class="login-required-btn">로그인하기</a>
                </div>
            </div>

            <div class="test-card" onclick="startTest('stress')">
                <div class="test-icon">
                    <i class="fas fa-heart"></i>
                </div>
                <h2>스트레스 관리 척도</h2>
                <p>현재 스트레스 수준과 대처 방식을 분석하여 건강한 스트레스 관리 방법을 제안합니다.</p>
                <button class="start-btn" id="stress-start-btn">검사 시작하기</button>
                <div class="login-required-overlay" id="stress-login-overlay" style="display: none;">
                    <h3><i class="fas fa-lock"></i> 로그인이 필요합니다</h3>
                    <p>검사를 시작하려면 먼저 로그인해주세요</p>
                    <a href="login.html" class="login-required-btn">로그인하기</a>
                </div>
            </div>
        </div>

        <!-- DiSC 테스트 섹션 -->
        <div id="disc-test" class="test-section">
            <h2><i class="fas fa-users"></i> DiSC 성격유형검사</h2>
            <div class="progress-bar">
                <div class="progress-fill" id="disc-progress"></div>
            </div>
            <div id="disc-questions"></div>
            <div class="nav-buttons">
                <button class="nav-btn prev" id="disc-prev" onclick="prevQuestion('disc')" disabled>이전</button>
                <button class="nav-btn next" id="disc-next" onclick="nextQuestion('disc')" disabled>다음</button>
            </div>
        </div>

        <!-- MBTI 테스트 섹션 -->
        <div id="mbti-test" class="test-section">
            <h2><i class="fas fa-user-friends"></i> MBTI 성격유형검사</h2>
            <div class="progress-bar">
                <div class="progress-fill" id="mbti-progress"></div>
            </div>
            <div id="mbti-questions"></div>
            <div class="nav-buttons">
                <button class="nav-btn prev" id="mbti-prev" onclick="prevQuestion('mbti')" disabled>이전</button>
                <button class="nav-btn next" id="mbti-next" onclick="nextQuestion('mbti')" disabled>다음</button>
            </div>
        </div>

        <!-- 스트레스 관리 테스트 섹션 -->
        <div id="stress-test" class="test-section">
            <h2><i class="fas fa-heart"></i> 스트레스 관리 척도</h2>
            <div class="progress-bar">
                <div class="progress-fill" id="stress-progress"></div>
            </div>
            <div id="stress-questions"></div>
            <div class="nav-buttons">
                <button class="nav-btn prev" id="stress-prev" onclick="prevQuestion('stress')" disabled>이전</button>
                <button class="nav-btn next" id="stress-next" onclick="nextQuestion('stress')" disabled>다음</button>
            </div>
        </div>

        <!-- 결과 섹션들 -->
        <div id="disc-result" class="result-section">
            <div class="result-header">
                <div class="result-type" id="disc-type"></div>
                <div class="result-description" id="disc-description"></div>
            </div>
            <div class="result-details" id="disc-details"></div>
            <div class="chart-container" id="disc-chart"></div>
            <div class="back-to-tests">
                <button class="back-btn" onclick="backToMain()">다른 검사하기</button>
            </div>
        </div>

        <div id="mbti-result" class="result-section">
            <div class="result-header">
                <div class="result-type" id="mbti-type"></div>
                <div class="result-description" id="mbti-description"></div>
            </div>
            <div class="result-details" id="mbti-details"></div>
            <div class="chart-container" id="mbti-chart"></div>
            <div class="back-to-tests">
                <button class="back-btn" onclick="backToMain()">다른 검사하기</button>
            </div>
        </div>

        <div id="stress-result" class="result-section">
            <div class="result-header">
                <div class="result-type" id="stress-type"></div>
                <div class="result-description" id="stress-description"></div>
            </div>
            <div class="result-details" id="stress-details"></div>
            <div class="chart-container" id="stress-chart"></div>
            <div class="back-to-tests">
                <button class="back-btn" onclick="backToMain()">다른 검사하기</button>
            </div>
        </div>

        <div class="footer">
            <p>&copy; 2024 청년 성격유형검사. 모든 권리 보유.</p>
        </div>
    </div>

    <script>
        // Supabase 설정
        const SUPABASE_PROJECT_ID = "lghwdvpnbvkihzgvwzpz";
        const SUPABASE_URL = `https://${SUPABASE_PROJECT_ID}.supabase.co`;
        const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxnaHdkdnBuYnZraWh6Z3Z3enB6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc0OTM5ODksImV4cCI6MjA3MzA2OTk4OX0.7ae1Cz706NOThj8lbJAfbHZW7nYWng8aZ4RJ9EDujMs";

        // Supabase 클라이언트 초기화
        let supabase;
        try {
            if (typeof window.supabase !== 'undefined') {
                supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
                console.log('Supabase 클라이언트가 성공적으로 초기화되었습니다.');
            } else {
                console.error('Supabase 라이브러리가 로드되지 않았습니다.');
                supabase = null;
            }
        } catch (error) {
            console.error('Supabase 초기화 오류:', error);
            supabase = null;
        }

        // 테스트 데이터
        const testData = {
            disc: {
                questions: [
                    {
                        question: "새로운 프로젝트를 시작할 때 나는...",
                        options: [
                            "빠르게 결정하고 실행한다",
                            "팀원들과 의견을 나눈다",
                            "신중하게 계획을 세운다",
                            "기존 방식대로 진행한다"
                        ]
                    },
                    {
                        question: "갈등 상황에서 나는...",
                        options: [
                            "직접적으로 문제를 해결한다",
                            "중재자 역할을 한다",
                            "상황을 분석한 후 대응한다",
                            "갈등을 피하려고 한다"
                        ]
                    },
                    {
                        question: "업무 환경에서 나는...",
                        options: [
                            "리더십을 발휘한다",
                            "팀워크를 중시한다",
                            "정확성을 추구한다",
                            "안정성을 우선한다"
                        ]
                    },
                    {
                        question: "변화에 대한 나의 태도는...",
                        options: [
                            "변화를 주도한다",
                            "변화에 적응한다",
                            "변화를 분석한다",
                            "변화를 신중히 받아들인다"
                        ]
                    },
                    {
                        question: "의사소통 스타일은...",
                        options: [
                            "직접적이고 명확하다",
                            "친근하고 열정적이다",
                            "논리적이고 체계적이다",
                            "신중하고 조용하다"
                        ]
                    }
                ],
                types: {
                    D: { name: "지배형 (Dominance)", description: "결과 지향적이고 도전적인 성격" },
                    I: { name: "영향형 (Influence)", description: "사람 중심적이고 열정적인 성격" },
                    S: { name: "안정형 (Steadiness)", description: "안정적이고 협력적인 성격" },
                    C: { name: "신중형 (Conscientiousness)", description: "정확하고 체계적인 성격" }
                }
            },
            mbti: {
                questions: [
                    {
                        question: "에너지를 얻는 방식은?",
                        options: [
                            "혼자만의 시간을 가지며 에너지를 얻는다 (I)",
                            "사람들과 함께 있을 때 에너지를 얻는다 (E)"
                        ]
                    },
                    {
                        question: "정보를 받아들이는 방식은?",
                        options: [
                            "구체적이고 실제적인 정보를 선호한다 (S)",
                            "가능성과 의미를 중시한다 (N)"
                        ]
                    },
                    {
                        question: "의사결정 방식은?",
                        options: [
                            "논리적이고 객관적 기준을 사용한다 (T)",
                            "가치와 사람의 감정을 고려한다 (F)"
                        ]
                    },
                    {
                        question: "생활 방식은?",
                        options: [
                            "계획적이고 체계적으로 생활한다 (J)",
                            "유연하고 자발적으로 생활한다 (P)"
                        ]
                    },
                    {
                        question: "문제 해결 방식은?",
                        options: [
                            "단계별로 체계적으로 접근한다",
                            "창의적이고 유연하게 접근한다"
                        ]
                    }
                ],
                types: {
                    "INTJ": { name: "건축가", description: "상상력이 풍부하고 전략적 사고를 하는 완벽주의자" },
                    "INTP": { name: "논리학자", description: "지식에 대한 갈증이 넘치는 혁신적인 발명가" },
                    "ENTJ": { name: "통솔자", description: "대담하고 상상력이 풍부한 강력한 의지의 지도자" },
                    "ENTP": { name: "변론가", description: "똑똑하고 호기심이 많은 사상가" },
                    "INFJ": { name: "옹호자", description: "선의의 옹호자이자 원칙주의자" },
                    "INFP": { name: "중재자", description: "항상 선을 행할 준비가 되어 있는 시적이고 친절한 이타주의자" },
                    "ENFJ": { name: "주인공", description: "카리스마 있고 영감을 주는 지도자" },
                    "ENFP": { name: "활동가", description: "열정적이고 창의적이며 사회적으로 자유로운 영혼" },
                    "ISTJ": { name: "논리주의자", description: "실용적이고 사실에 근거한 신뢰할 수 있는 사람" },
                    "ISFJ": { name: "수호자", description: "따뜻하고 헌신적이며 책임감 있는 수호자" },
                    "ESTJ": { name: "경영자", description: "뛰어난 관리자이자 전통과 질서를 중시하는 사람" },
                    "ESFJ": { name: "집정관", description: "사려 깊고 헌신적이며 협력적인 돌봄이" },
                    "ISTP": { name: "만능재주꾼", description: "대담하고 실용적인 실험정신을 가진 장인" },
                    "ISFP": { name: "모험가", description: "유연하고 매력적인 예술가" },
                    "ESTP": { name: "사업가", description: "똑똑하고 에너지 넘치는 인식가" },
                    "ESFP": { name: "연예인", description: "자유로운 영혼의 연예인" }
                }
            },
            stress: {
                questions: [
                    {
                        question: "최근 스트레스를 받는 상황이 얼마나 자주 있었나요?",
                        options: [
                            "매우 자주 (5점)",
                            "자주 (4점)",
                            "가끔 (3점)",
                            "거의 없음 (2점)",
                            "전혀 없음 (1점)"
                        ]
                    },
                    {
                        question: "스트레스 상황에서 나의 반응은?",
                        options: [
                            "적극적으로 문제를 해결하려고 한다",
                            "다른 사람에게 도움을 요청한다",
                            "시간을 두고 신중하게 대응한다",
                            "스트레스를 피하려고 한다"
                        ]
                    },
                    {
                        question: "스트레스 해소 방법은?",
                        options: [
                            "운동이나 활동적인 방법",
                            "친구들과 대화",
                            "혼자만의 시간",
                            "취미 활동"
                        ]
                    },
                    {
                        question: "스트레스로 인한 신체 증상은?",
                        options: [
                            "두통이나 소화불량",
                            "불면증이나 피로",
                            "긴장감이나 불안",
                            "전혀 없음"
                        ]
                    },
                    {
                        question: "스트레스 관리에 대한 나의 태도는?",
                        options: [
                            "적극적으로 관리 방법을 찾는다",
                            "주변의 도움을 받는다",
                            "시간이 지나면 해결될 것이라 생각한다",
                            "스트레스를 무시한다"
                        ]
                    }
                ],
                levels: {
                    low: { name: "낮은 스트레스", description: "건강한 스트레스 관리 상태입니다" },
                    moderate: { name: "보통 스트레스", description: "적절한 관리가 필요한 상태입니다" },
                    high: { name: "높은 스트레스", description: "적극적인 스트레스 관리가 필요합니다" }
                }
            }
        };

        // 현재 테스트 상태
        let currentTest = null;
        let currentQuestion = 0;
        let answers = {};

        // 테스트 시작
        function startTest(testType) {
            // 로그인 상태 확인
            if (!isLoggedIn()) {
                showLoginRequired(testType);
                return;
            }
            
            currentTest = testType;
            currentQuestion = 0;
            answers = {};
            
            // 메인 메뉴 숨기기
            document.getElementById('main-menu').style.display = 'none';
            
            // 테스트 헤더 표시
            document.getElementById('test-header').classList.add('active');
            
            // 테스트 섹션 표시
            document.getElementById(testType + '-test').classList.add('active');
            
            // 테스트 헤더 업데이트
            updateTestHeader(testType);
            
            loadQuestion(testType, 0);
            updateProgress(testType);
        }

        // 로그인 상태 확인
        function isLoggedIn() {
            const currentUser = localStorage.getItem('current_user');
            const adminToken = localStorage.getItem('admin_token');
            return !!(currentUser || adminToken);
        }

        // 로그인 필요 오버레이 표시
        function showLoginRequired(testType) {
            const overlay = document.getElementById(testType + '-login-overlay');
            const startBtn = document.getElementById(testType + '-start-btn');
            
            overlay.style.display = 'flex';
            startBtn.disabled = true;
            
            // 알림 표시
            showNotification('검사를 시작하려면 로그인이 필요합니다.', 'error');
        }

        // 로그인 상태에 따른 UI 업데이트
        function updateTestCardsForLogin() {
            const isLoggedIn = !!(localStorage.getItem('current_user') || localStorage.getItem('admin_token'));
            
            const testTypes = ['disc', 'mbti', 'stress'];
            testTypes.forEach(testType => {
                const overlay = document.getElementById(testType + '-login-overlay');
                const startBtn = document.getElementById(testType + '-start-btn');
                
                if (isLoggedIn) {
                    overlay.style.display = 'none';
                    startBtn.disabled = false;
                } else {
                    overlay.style.display = 'flex';
                    startBtn.disabled = true;
                }
            });
        }

        // 질문 로드
        function loadQuestion(testType, questionIndex) {
            const questionsContainer = document.getElementById(testType + '-questions');
            const question = testData[testType].questions[questionIndex];
            
            questionsContainer.innerHTML = `
                <div class="question">
                    <h3>Q${questionIndex + 1}. ${question.question}</h3>
                    <div class="options">
                        ${question.options.map((option, index) => `
                            <div class="option" onclick="selectOption('${testType}', ${questionIndex}, ${index})">
                                <input type="radio" name="q${questionIndex}" value="${index}" id="q${questionIndex}_${index}">
                                <label for="q${questionIndex}_${index}">${option}</label>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
            
            updateNavButtons(testType);
        }

        // 옵션 선택
        function selectOption(testType, questionIndex, optionIndex) {
            answers[questionIndex] = optionIndex;
            
            // 시각적 피드백
            const options = document.querySelectorAll(`#${testType}-questions .option`);
            options.forEach(option => option.classList.remove('selected'));
            options[optionIndex].classList.add('selected');
            
            updateNavButtons(testType);
        }

        // 네비게이션 버튼 업데이트
        function updateNavButtons(testType) {
            const prevBtn = document.getElementById(testType + '-prev');
            const nextBtn = document.getElementById(testType + '-next');
            
            prevBtn.disabled = currentQuestion === 0;
            
            if (currentQuestion === testData[testType].questions.length - 1) {
                nextBtn.textContent = '결과 보기';
                nextBtn.disabled = answers[currentQuestion] === undefined;
            } else {
                nextBtn.textContent = '다음';
                nextBtn.disabled = answers[currentQuestion] === undefined;
            }
        }

        // 이전 질문
        function prevQuestion(testType) {
            if (currentQuestion > 0) {
                currentQuestion--;
                loadQuestion(testType, currentQuestion);
                updateProgress(testType);
            }
        }

        // 다음 질문
        function nextQuestion(testType) {
            if (currentQuestion < testData[testType].questions.length - 1) {
                currentQuestion++;
                loadQuestion(testType, currentQuestion);
                updateProgress(testType);
            } else {
                showResult(testType);
            }
        }

        // 진행률 업데이트
        function updateProgress(testType) {
            const progress = ((currentQuestion + 1) / testData[testType].questions.length) * 100;
            document.getElementById(testType + '-progress').style.width = progress + '%';
            
            // 테스트 헤더의 진행률 정보 업데이트
            updateTestProgress(testType);
        }

        // 테스트 헤더 업데이트
        function updateTestHeader(testType) {
            const testNames = {
                'disc': 'DiSC 성격유형검사',
                'mbti': 'MBTI 성격유형검사',
                'stress': '스트레스 관리 척도'
            };
            
            document.getElementById('current-test-title').textContent = testNames[testType];
            updateTestProgress(testType);
        }

        // 테스트 진행률 정보 업데이트
        function updateTestProgress(testType) {
            const current = currentQuestion + 1;
            const total = testData[testType].questions.length;
            document.getElementById('test-progress-info').textContent = `${current}/${total}`;
        }

        // 결과 표시
        function showResult(testType) {
            document.getElementById(testType + '-test').classList.remove('active');
            document.getElementById(testType + '-result').classList.add('active');
            
            calculateResult(testType);
        }

        // 결과 계산
        function calculateResult(testType) {
            if (testType === 'disc') {
                calculateDiSCResult();
            } else if (testType === 'mbti') {
                calculateMBTIResult();
            } else if (testType === 'stress') {
                calculateStressResult();
            }
        }

        // DiSC 결과 계산
        function calculateDiSCResult() {
            const scores = { D: 0, I: 0, S: 0, C: 0 };
            
            // 간단한 점수 계산 로직
            Object.values(answers).forEach(answer => {
                scores[['D', 'I', 'S', 'C'][answer]]++;
            });
            
            const maxScore = Math.max(...Object.values(scores));
            const resultType = Object.keys(scores).find(key => scores[key] === maxScore);
            
            document.getElementById('disc-type').textContent = testData.disc.types[resultType].name;
            document.getElementById('disc-description').textContent = testData.disc.types[resultType].description;
            
            // 상세 정보
            document.getElementById('disc-details').innerHTML = `
                <div class="detail-card">
                    <h4>특징</h4>
                    <p>이 유형의 주요 특징과 행동 패턴을 보여줍니다.</p>
                </div>
                <div class="detail-card">
                    <h4>강점</h4>
                    <p>이 유형이 가진 강점과 장점을 설명합니다.</p>
                </div>
                <div class="detail-card">
                    <h4>개선점</h4>
                    <p>개발이 필요한 영역과 개선 방향을 제시합니다.</p>
                </div>
            `;
            
            // 차트
            document.getElementById('disc-chart').innerHTML = `
                <h4>DiSC 점수 분포</h4>
                ${Object.entries(scores).map(([type, score]) => `
                    <div class="chart-bar">
                        <div class="chart-label">${testData.disc.types[type].name}</div>
                        <div class="chart-fill" style="width: ${(score / maxScore) * 100}%"></div>
                        <span>${score}점</span>
                    </div>
                `).join('')}
            `;
        }

        // MBTI 결과 계산
        function calculateMBTIResult() {
            // 간단한 MBTI 계산 로직
            const resultType = "ENFP"; // 예시 결과
            
            document.getElementById('mbti-type').textContent = testData.mbti.types[resultType].name;
            document.getElementById('mbti-description').textContent = testData.mbti.types[resultType].description;
            
            document.getElementById('mbti-details').innerHTML = `
                <div class="detail-card">
                    <h4>성격 특성</h4>
                    <p>이 유형의 주요 성격 특성과 행동 패턴을 설명합니다.</p>
                </div>
                <div class="detail-card">
                    <h4>직업 추천</h4>
                    <p>이 유형에 적합한 직업과 진로 방향을 제시합니다.</p>
                </div>
                <div class="detail-card">
                    <h4>인간관계</h4>
                    <p>이 유형의 인간관계 스타일과 소통 방법을 설명합니다.</p>
                </div>
            `;
            
            document.getElementById('mbti-chart').innerHTML = `
                <h4>MBTI 차원별 점수</h4>
                <div class="chart-bar">
                    <div class="chart-label">외향성(E)</div>
                    <div class="chart-fill" style="width: 70%"></div>
                    <span>70%</span>
                </div>
                <div class="chart-bar">
                    <div class="chart-label">직관성(N)</div>
                    <div class="chart-fill" style="width: 80%"></div>
                    <span>80%</span>
                </div>
                <div class="chart-bar">
                    <div class="chart-label">감정형(F)</div>
                    <div class="chart-fill" style="width: 75%"></div>
                    <span>75%</span>
                </div>
                <div class="chart-bar">
                    <div class="chart-label">인식형(P)</div>
                    <div class="chart-fill" style="width: 65%"></div>
                    <span>65%</span>
                </div>
            `;
        }

        // 스트레스 결과 계산
        function calculateStressResult() {
            const totalScore = Object.values(answers).reduce((sum, answer) => sum + answer + 1, 0);
            let stressLevel;
            
            if (totalScore <= 10) {
                stressLevel = 'low';
            } else if (totalScore <= 20) {
                stressLevel = 'moderate';
            } else {
                stressLevel = 'high';
            }
            
            document.getElementById('stress-type').textContent = testData.stress.levels[stressLevel].name;
            document.getElementById('stress-description').textContent = testData.stress.levels[stressLevel].description;
            
            document.getElementById('stress-details').innerHTML = `
                <div class="detail-card">
                    <h4>현재 상태</h4>
                    <p>당신의 현재 스트레스 수준과 상태를 분석합니다.</p>
                </div>
                <div class="detail-card">
                    <h4>관리 방법</h4>
                    <p>효과적인 스트레스 관리 방법과 기법을 제안합니다.</p>
                </div>
                <div class="detail-card">
                    <h4>권장사항</h4>
                    <p>건강한 생활을 위한 구체적인 권장사항을 제시합니다.</p>
                </div>
            `;
            
            document.getElementById('stress-chart').innerHTML = `
                <h4>스트레스 수준</h4>
                <div class="chart-bar">
                    <div class="chart-label">전체 점수</div>
                    <div class="chart-fill" style="width: ${(totalScore / 25) * 100}%"></div>
                    <span>${totalScore}/25점</span>
                </div>
            `;
        }

        // 메인으로 돌아가기
        function backToMain() {
            // 진행 중인 테스트가 있는지 확인
            if (currentTest && Object.keys(answers).length > 0) {
                if (confirm('진행 중인 검사가 있습니다. 정말로 메인으로 돌아가시겠습니까?\n(진행 상황은 저장되지 않습니다)')) {
                    resetToMain();
                }
            } else {
                resetToMain();
            }
        }

        // 메인 화면으로 리셋
        function resetToMain() {
            // 모든 섹션 비활성화
            document.querySelectorAll('.test-section, .result-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // 테스트 헤더 숨기기
            document.getElementById('test-header').classList.remove('active');
            
            // 메인 메뉴 표시
            document.getElementById('main-menu').style.display = 'grid';
            
            // 테스트 상태 리셋
            currentTest = null;
            currentQuestion = 0;
            answers = {};
            
            // 알림 표시
            showNotification('메인 화면으로 돌아왔습니다.', 'success');
        }

        // Supabase 연동을 위한 함수들 (추후 구현)
        function saveResult(testType, result) {
            // Supabase에 결과 저장하는 로직
            console.log('결과 저장:', testType, result);
        }

        function loadUserHistory() {
            // 사용자 검사 이력 로드
            console.log('사용자 이력 로드');
        }

        // 페이지 로드 시 초기화
        document.addEventListener('DOMContentLoaded', function() {
            console.log('청년 성격유형검사 페이지가 로드되었습니다.');
            checkLoginStatus();
        });

        // 로그인 상태 확인
        function checkLoginStatus() {
            const currentUser = localStorage.getItem('current_user');
            const adminToken = localStorage.getItem('admin_token');
            
            if (currentUser) {
                // 일반 사용자 로그인 상태
                const user = JSON.parse(currentUser);
                showUserNav(user.name);
            } else if (adminToken) {
                // 관리자 로그인 상태
                const adminUser = localStorage.getItem('admin_user');
                if (adminUser) {
                    const admin = JSON.parse(adminUser);
                    showUserNav(admin.name + ' (관리자)');
                }
            } else {
                // 로그인하지 않은 상태
                showGuestNav();
            }
            
            // 테스트 카드 상태 업데이트
            updateTestCardsForLogin();
        }

        // 게스트 네비게이션 표시
        function showGuestNav() {
            document.getElementById('guest-nav').style.display = 'flex';
            document.getElementById('user-nav').classList.remove('active');
        }

        // 사용자 네비게이션 표시
        function showUserNav(userName) {
            document.getElementById('guest-nav').style.display = 'none';
            document.getElementById('user-nav').classList.add('active');
            document.getElementById('user-name').textContent = userName + '님';
        }

        // 로그아웃
        function logout() {
            if (confirm('정말로 로그아웃하시겠습니까?')) {
                // 모든 로그인 정보 삭제
                localStorage.removeItem('current_user');
                localStorage.removeItem('user_token');
                localStorage.removeItem('admin_token');
                localStorage.removeItem('admin_user');
                
                // 게스트 네비게이션으로 변경
                showGuestNav();
                
                // 테스트 카드 상태 업데이트
                updateTestCardsForLogin();
                
                // 알림 표시
                showNotification('로그아웃되었습니다.', 'success');
            }
        }

        // 알림 표시 함수
        function showNotification(message, type) {
            // 기존 알림이 있다면 제거
            const existingNotification = document.querySelector('.notification');
            if (existingNotification) {
                existingNotification.remove();
            }

            // 새 알림 생성
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            notification.textContent = message;
            
            // 스타일 적용
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 20px;
                border-radius: 10px;
                color: white;
                font-weight: 600;
                z-index: 1000;
                animation: slideIn 0.3s ease-out;
                max-width: 300px;
                word-wrap: break-word;
            `;
            
            if (type === 'success') {
                notification.style.background = 'linear-gradient(45deg, #28a745, #20c997)';
            } else if (type === 'error') {
                notification.style.background = 'linear-gradient(45deg, #dc3545, #e74c3c)';
            } else {
                notification.style.background = 'linear-gradient(45deg, #667eea, #764ba2)';
            }
            
            // 페이지에 추가
            document.body.appendChild(notification);
            
            // 3초 후 자동 제거
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease-in';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.remove();
                    }
                }, 300);
            }, 3000);
        }

        // CSS 애니메이션 추가
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from {
                    transform: translateX(100%);
                    opacity: 0;
                }
                to {
                    transform: translateX(0);
                    opacity: 1;
                }
            }
            
            @keyframes slideOut {
                from {
                    transform: translateX(0);
                    opacity: 1;
                }
                to {
                    transform: translateX(100%);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
